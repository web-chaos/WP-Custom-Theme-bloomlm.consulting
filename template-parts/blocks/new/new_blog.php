<section class="new-blog ptb-100">
    <div class="container">
        <div class="new-blog__header h2-mb">
            <h2><?php echo get_sub_field( 'title' ); ?></h2>
			<?php $link = get_sub_field( 'link' ); ?>
			<?php if ( $link ) { ?>
				<a href="<?php echo esc_url( get_term_link( $link ) ); ?>">
                    <?php echo esc_html__( 'Другие посты', 'bloomlm' ); ?>
                    <svg width="24" height="20" viewBox="0 0 24 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.2917 19.7007C13.1987 19.6079 13.125 19.4976 13.0747 19.3762C13.0243 19.2548 12.9984 19.1246 12.9984 18.9932C12.9984 18.8618 13.0243 18.7317 13.0747 18.6103C13.125 18.4889 13.1987 18.3786 13.2917 18.2857L20.5855 10.9932L0.999218 10.9932C0.734001 10.9932 0.479647 10.8879 0.29211 10.7003C0.104574 10.5128 -0.000781985 10.2584 -0.000781973 9.99323C-0.000781962 9.72801 0.104574 9.47366 0.29211 9.28612C0.479647 9.09859 0.734001 8.99323 0.999218 8.99323L20.5855 8.99323L13.2917 1.70073C13.1041 1.51309 12.9987 1.2586 12.9987 0.993231C12.9987 0.727867 13.1041 0.473372 13.2917 0.285731C13.4794 0.0980906 13.7339 -0.00732467 13.9992 -0.00732466C14.2646 -0.00732465 14.5191 0.0980907 14.7067 0.285731L23.7067 9.28573C23.7997 9.3786 23.8734 9.48889 23.9238 9.61029C23.9741 9.73169 24 9.86181 24 9.99323C24 10.1246 23.9741 10.2548 23.9238 10.3762C23.8734 10.4976 23.7997 10.6079 23.7067 10.7007L14.7067 19.7007C14.6138 19.7937 14.5036 19.8675 14.3822 19.9178C14.2608 19.9681 14.1306 19.994 13.9992 19.994C13.8678 19.994 13.7377 19.9681 13.6163 19.9178C13.4949 19.8675 13.3846 19.7937 13.2917 19.7007Z" fill="black"/></svg>
                </a>
			<?php } ?>
            <svg width="33" height="50" viewBox="0 0 33 50" fill="none" xmlns="http://www.w3.org/2000/svg"><mask id="mask0_1458_10544" style="mask-type:alpha" maskUnits="userSpaceOnUse" x="0" y="16" width="33" height="34"><ellipse cx="16.3" cy="33.0769" rx="16.3" ry="16.3" fill="#4138B1"/></mask><g mask="url(#mask0_1458_10544)"><ellipse cx="33.2267" cy="50.0036" rx="16.6134" ry="16.6135" fill="#CE4545"/><ellipse cx="33.2267" cy="16.7771" rx="16.6134" ry="16.6135" fill="#CE4545"/><ellipse cx="0.000156403" cy="16.7771" rx="16.6134" ry="16.6135" fill="#DB3F2D"/><ellipse cx="0.000156403" cy="50.0036" rx="16.6134" ry="16.6135" fill="#CE4545"/></g><path d="M16.6134 16.7771C0.000169798 16.7771 9.17552 16.7771 0.000170097 16.7771C0.000170097 25.9525 0.00170396 0.163574 0.000170097 16.7771C0.000170097 7.60169 0.000166808 16.7771 0 0.163574C9.17535 0.163574 16.6134 7.60169 16.6134 16.7771Z" fill="#CE4545"/><path d="M16.6134 16.7434C0.000169798 16.7434 9.17552 16.7434 0.000170097 16.7434C0.000170097 7.56806 0.00170396 33.3569 0.000170097 16.7434C0.000170097 25.9188 0.000166808 16.7434 0 33.3569C9.17535 33.3569 16.6134 25.9188 16.6134 16.7434Z" fill="#CE4545"/></svg>
        </div>
        <div class="new-blog__wrapper">
            <?php
                $args = array(
                    'post_type'      => 'post',
                    'posts_per_page' => 3,
                    'orderby'        => 'date',
                    'order'          => 'DESC',
                );

                $query = new WP_Query($args);

                if ($query->have_posts()) {
                    while ($query->have_posts()) { $query->the_post(); ?>
                        <div class="new-blog-item">
                            <div class="new-blog-item--date"><?php echo get_the_date( 'j.m.Y' ); ?></div>
                            <a href="<?php the_permalink(); ?>" class="new-blog-item--title"><?php the_title(); ?></a>
                            <p class="new-blog-item--description">
                                <?php 
                                    while ( have_rows( 'flexible_blocks' ) && the_row() ){
                                            if ( get_row_layout() == 'new_content' && get_sub_field( 'show_short_description' ) == 1 && $desc = get_sub_field( 'short_description' ) ) { 
                                                echo wp_trim_words( $desc, 25, '...' );
                                                break;
                                        }
                                    }
                                ?>
                            </p>
                            <a href="<?php the_permalink(); ?>" class="new-blog-item--more">
                                <?php echo esc_html__( 'Подробнее', 'bloomlm' ); ?>
                                <svg width="24" height="20" viewBox="0 0 24 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.2917 19.7022C13.1987 19.6093 13.125 19.499 13.0747 19.3776C13.0243 19.2562 12.9984 19.1261 12.9984 18.9947C12.9984 18.8633 13.0243 18.7331 13.0747 18.6118C13.125 18.4904 13.1987 18.3801 13.2917 18.2872L20.5855 10.9947L0.999218 10.9947C0.734001 10.9947 0.479647 10.8893 0.29211 10.7018C0.104574 10.5143 -0.000781985 10.2599 -0.000781973 9.99469C-0.000781962 9.72948 0.104574 9.47512 0.29211 9.28759C0.479647 9.10005 0.734001 8.99469 0.999218 8.99469L20.5855 8.99469L13.2917 1.7022C13.1041 1.51456 12.9987 1.26006 12.9987 0.994696C12.9987 0.729332 13.1041 0.474837 13.2917 0.287196C13.4794 0.0995555 13.7339 -0.00585982 13.9992 -0.00585981C14.2646 -0.0058598 14.5191 0.0995555 14.7067 0.287196L23.7067 9.28719C23.7997 9.38007 23.8734 9.49036 23.9238 9.61175C23.9741 9.73315 24 9.86328 24 9.99469C24 10.1261 23.9741 10.2562 23.9238 10.3776C23.8734 10.499 23.7997 10.6093 23.7067 10.7022L14.7067 19.7022C14.6138 19.7952 14.5036 19.8689 14.3822 19.9193C14.2608 19.9696 14.1306 19.9955 13.9992 19.9955C13.8678 19.9955 13.7377 19.9696 13.6163 19.9193C13.4949 19.8689 13.3846 19.7952 13.2917 19.7022Z" fill="#CE4545"/></svg>
                            </a>
                        </div>
                    <?php }
                    wp_reset_postdata();
                }
            ?>
        </div>
    </div>
</section>